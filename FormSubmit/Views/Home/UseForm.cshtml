@model FormDetail

@{
    ViewData["Title"] = "UseForm";
}


<div class="row">
    <div class="col-md-2">

    </div>
    <div class="col-md-8">
        <form asp-action="UseForm" id="myFrom" method="post">

            @Html.HiddenFor(x => x.id)
            <div class="card-header">@Model.Name</div>
            <div class="alert-secondary">@Model.Description</div>

            @foreach (var data in Model.FormData)
            {
                if (data.Type == "InputText")
                {
                    <div class="form-group row">
                        <label for="@data.Id" class="col-sm-2 col-form-label">@data.InputLabel</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control " id="@data.Id" placeholder="">
                        </div>
                    </div>
                }
                else if (data.Type == "InputRadio")
                {
                    <br />
                    <div class="row">
                        <div class="col-sm-2 col-form-label col-form-label-sm"></div>
                        <div class="col-sm-10">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="@data.InputName" id="@data.Id" value="@data.value" checked>
                                <label class="form-check-label" for="@data.Id">
                                    @data.InputLabel
                                </label>
                            </div>
                        </div>
                    </div>
                }
            }

            <button id="Save" class="btn btn-primary">Save</button>

        </form>

    </div>
    <div class="col-md-2">

    </div>
</div>


<script>

    $("#Save").on('click', function (e) {
        e.preventDefault();

        const formInput = $('#myFrom input');

        var dataList = [];

        for (let i = 0; i < formInput.length; i++) {
            const data = {
                ElmId: $(formInput[i]).attr("id"),
                value: $(formInput[i]).val()
            };

            dataList.push(data);
        }

        const url = location.origin +"/Home/UseForm";

        $.ajax({
            type: "POST",
            url: url,
            data: JSON.stringify(dataList),
            contentType: "application/json; charset=utf-8",
            dataType: "html",
            success: function (response) {

                if (response !== "200") {
                    alert("Some Error occur.");
                }
                else {
                    alert("Success");
                    window.location.reload();
                }

                return false;
            },
            failure: function () {
                alert("Some Error occur.");
            },
            error: function () {
                alert("Some Error occur.");
            }
        });



        return false;
    });

</script>